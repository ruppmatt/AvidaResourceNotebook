<!DOCTYPE html>

<html>
<head>
   <meta charset='UTF-8'>
   <title>Avida Resource Testing</title>
   <link rel='stylesheet' type='text/css' href='/avidares/css/resources.css'>
   <link rel='stylesheet' type='text/css' href='https://ajax.googleapis.com/ajax/libs/dojo/1.12.2/dijit/themes/nihilo/nihilo.css'>
</head>
<body>
   <script src="//ajax.googleapis.com/ajax/libs/dojo/1.12.2/dojo/dojo.js" data-dojo-config="
   async:true,
   packages:[
      {name:'socketio', location:'https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/', main:'socket.io'},
      {name:'lipsum', location:'/avidares/libs/', main:'holder-ipsum'}
      ]"></script>

    <div id='root'>
      <div id='header'><span>Avida Resource Testing</span></div>
      <div id='workspace'>
        <div id='tools'>
          <div id='commands' class='toolbox'>
            <div class='tool' id='new_resource'>New RESOURCE</div>
            <div class='tool' id='new_gradient'>New GRADIENT_RESOURCE</div>
            <div class='tool' id='reset'>Reset</div>
          </div>
          <div id='experiments' class='toolbox'></div>
        </div>
        <div id='works'></div>
      </div>
      <div id='network'>Offline</div>
    </div>


<script>
    require([
      'dojo/dom'
      ,'dojo/dom-construct'
      ,'dojo/html'
      ,'dojo/on'
      ,'dojo/parser'
      ,'lipsum'
      ,'socketio'
      ,'dojo/domReady!'
      ,'dijit/form/Form'
      ,'dijit/form/Button'
      ,'dijit/form/ValidationTextBox'
      ,'dijit/form/CheckBox'
      ,'dijit/form/RadioButton'
      ,'dijit/form/HorizontalSlider'
    ],
      function(dom, construct, html, on, parser, ipsum, socketio, ready,
        Form, Button, ValidationTextBox, CheckBox, RadioButton, HorizontalSlider
        ){


        var id = dom.byId;
        var set = html.set;
        var create = construct.create;
        var place = construct.place;


        function labled_widget(label, widget){
          var d = create('div', {class:'labled_widget'});
          var l = create('label', {class:'widget_label', innerHTML:label}, d);
          var w = (!('domNode' in widget)) ? place(widget, d) : place(widget.domNode,d);
          return d;
        }

        function widget_row(widgets){
          var d = create('div', {class:'widget_row'});
          for (w of widgets){
            place(w, d);
          }
          return d;
        }

        function radiobuttons(rbs, f){
          var d = create('div', {class:'radiobuttons'});
          for (r of rbs){
            console.log(r);
            place(r.domNode, d);
            place(r.domNode, f.domNode);
          }
          return d;
        }



        var w = construct.create('div', {class:'work'}, works);

        var h = construct.create('div', {class:'work_header'}, w);

        var w_id = construct.create('div', {class:'work_id'}, h);
        var w_title = construct.create('div', {class:'work_title'}, h);

        var w_form = construct.create('div', {class:'work_form'}, w);
        var w_output = construct.create('div', {class:'work_output'}, w);

        set(w_id, '0');
        set(w_title, 'RESOURCE');

        var d_form = new Form({}, 'work_form');
        var lw = labled_widget('Title', new ValidationTextBox({value:'Untitled'},'work_title'));
        place(lw, d_form.domNode);

        var av_row = widget_row([
          labled_widget('Random Seed', new ValidationTextBox({style:{width:'3em'},value:-1}, 'random_seed')),
          labled_widget('WORLD_X', new ValidationTextBox({style:{width:'3em'}, value:60}, 'world_x')),
          labled_widget('WORLD_Y', new ValidationTextBox({style:{width:'3em'}, value:60}, 'world_y'))
        ]);
        place(av_row, d_form.domNode);

        var geo_row = widget_row([
          labled_widget('Geometry', radiobuttons(
            [
              new RadioButton({checked:true, value:'grid', name:'geometry_rbs'}, 'rb_grid'),
              new RadioButton({checked:false, value:'torus', name:'geometry_rbs'}, 'rb_torus')
            ],d_form))
          ]);

          /*
          labled_widget('Initial', new ValidationTextBox({style:{width:'3em'},value:0.0}), 'initial'),
          labled_widget('Inflow', new ValidationTextBox({style:{width:'3em'},value:0.0}), 'inflow'),
          labled_widget('Outflow', new ValidationTextBox({style:{width:'3em'},value:0.0}), 'outflow')
        ]);*/
        place(geo_row, d_form.domNode);



        place(d_form.domNode, w_form);





        function create_res_work(){
          n = construct.create('div', {class:'work,resource'}, 'works');
        }

        function create_gradient_work(){
          n = construct.create('div', {class:'work,gradient'}, 'works');
        }

        on(id('new_resource'), 'click', function(e){
          create_res_work();
        });

        on(id('new_gradient'), 'click', function(e){
          create_gradient_work();
        });

        on(id('reset'), 'click', function(e){
          construct.empty('works');
          construct.empty('experiments');
        });

      });
</script>
</body>
</html>
